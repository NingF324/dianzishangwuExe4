{% extends "base.html" %}
{% block title %}CompkeySys{% endblock %}
{% block head %}
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@100;200;300;400;500;600;700;800;900&display=swap"
          rel="stylesheet">

    <title>Space Dynamic - SEO HTML5 Template</title>

    <!-- Bootstrap core CSS -->
    <link href="../static/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">

    <!-- Additional CSS Files -->
    <link rel="stylesheet" href="../static/assets/css/fontawesome.css">
    <link rel="stylesheet" href="../static/assets/css/templatemo-space-dynamic.css">
    <link rel="stylesheet" href="../static/assets/css/animated.css">
    <link rel="stylesheet" href="../static/assets/css/owl.css">
{% endblock %}
{% block body %}
    <section>
        <div class="main-banner wow fadeIn" id="top" data-wow-duration="1s" data-wow-delay="0.5s">
            <div class="container">
                <div class="row">
                    <div class="col-lg-12">
                        <div class="row">
                            <div class="col-lg-6 align-self-center">
                                <div class="left-content header-text wow fadeInLeft" data-wow-duration="1s"
                                     data-wow-delay="1s">
                                    <h6>欢迎来到 CompkeySys</h6>
                                    <h2>我们提供<em>创意建议</em>和<span>基于关键词算法</span>的营销</h2>
                                    <p>CompkeySys 是一个基于 Compkey 算法的关键词评估和推荐网站，我们的 github 仓库地址是<a
                                            rel="nofollow" href="https://github.com/NingF324/dianzishangwuExe4"
                                            target="_parent">CompkeySys</a>。</p>
                                    <form method="get" action="/compkey/lists" role="search">
                                        <fieldset>
                                            <input name="seedword" type="search" class="form-control" id="keyword"
                                                   placeholder="输入一个种子关键词..." aria-label="Search"
                                                   autocomplete="on" required onclick="queryAllImpNo()"
                                                   onkeydown="if(event.keyCode===13) { return handleSearch(); }">
                                        </fieldset>
                                        <fieldset>
                                            <button type="submit" class="main-button">搜索</button>
                                        </fieldset>
                                        <div style="background-color: #ffffff; margin: 0 34px; border-radius: 10px;">
                                            <ul id="impNoListUl"></ul>
                                        </div>
                                    </form>
                                </div>
                            </div>
                            <div class="col-lg-6">
                                <div class="right-image wow fadeInRight" data-wow-duration="1s" data-wow-delay="0.5s">
                                    <img src="../static/assets/images/banner-right-image.png" alt="team meeting">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="about" class="about-us section">
            <div class="container">
                <div class="row">
                    <div class="col-lg-4">
                        <div class="left-image wow fadeIn" data-wow-duration="1s" data-wow-delay="0.2s">
                            <img src="../static/assets/images/about-left-image.png" alt="person graphic">
                        </div>
                    </div>
                    <div class="col-lg-8 align-self-center">
                        <div class="services">
                            <div class="row">
                                <div class="col-lg-6">
                                    <div class="item wow fadeIn" data-wow-duration="1s" data-wow-delay="0.5s">
                                        <div class="icon">
                                            <img src="../static/assets/images/service-icon-01.png" alt="reporting">
                                        </div>
                                        <div class="right-text">
                                            <h4>关键词分析</h4>
                                            <p>Lorem ipsum dolor sit amet, ctetur aoi adipiscing eliter</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-6">
                                    <div class="item wow fadeIn" data-wow-duration="1s" data-wow-delay="0.7s">
                                        <div class="icon">
                                            <img src="../static/assets/images/service-icon-02.png" alt="">
                                        </div>
                                        <div class="right-text">
                                            <h4>关键词报告</h4>
                                            <p>Lorem ipsum dolor sit amet, ctetur aoi adipiscing eliter</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-6">
                                    <div class="item wow fadeIn" data-wow-duration="1s" data-wow-delay="0.9s">
                                        <div class="icon">
                                            <img src="../static/assets/images/service-icon-03.png" alt="">
                                        </div>
                                        <div class="right-text">
                                            <h4>关键词对比</h4>
                                            <p>Lorem ipsum dolor sit amet, ctetur aoi adipiscing eliter</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-6">
                                    <div class="item wow fadeIn" data-wow-duration="1s" data-wow-delay="1.1s">
                                        <div class="icon">
                                            <img src="../static/assets/images/service-icon-04.png" alt="">
                                        </div>
                                        <div class="right-text">
                                            <h4>关键词建议</h4>
                                            <p>Lorem ipsum dolor sit amet, ctetur aoi adipiscing eliter</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="portfolio" class="our-portfolio section">
            <div class="container">
                <div class="row">
                    <div class="col-lg-6 offset-lg-3">
                        <div class="section-heading  wow bounceIn" data-wow-duration="1s" data-wow-delay="0.2s">
                            <h2>查看我们的系统<em>提供</em>什么以及我们<span>提供</span>什么</h2>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-lg-3 col-sm-6">
                        <a href="#">
                            <div class="item wow bounceInUp" data-wow-duration="1s" data-wow-delay="0.3s">
                                <div class="hidden-content">
                                    <h4>关键词分析</h4>
                                    <p>Lorem ipsum dolor sit ameti ctetur aoi adipiscing eto.</p>
                                </div>
                                <div class="showed-content">
                                    <img src="../static/assets/images/portfolio-image.png" alt="">
                                </div>
                            </div>
                        </a>
                    </div>
                    <div class="col-lg-3 col-sm-6">
                        <a href="#">
                            <div class="item wow bounceInUp" data-wow-duration="1s" data-wow-delay="0.4s">
                                <div class="hidden-content">
                                    <h4>关键词报告</h4>
                                    <p>Lorem ipsum dolor sit ameti ctetur aoi adipiscing eto.</p>
                                </div>
                                <div class="showed-content">
                                    <img src="../static/assets/images/portfolio-image.png" alt="">
                                </div>
                            </div>
                        </a>
                    </div>
                    <div class="col-lg-3 col-sm-6">
                        <a href="#">
                            <div class="item wow bounceInUp" data-wow-duration="1s" data-wow-delay="0.5s">
                                <div class="hidden-content">
                                    <h4>关键词对比</h4>
                                    <p>Lorem ipsum dolor sit ameti ctetur aoi adipiscing eto.</p>
                                </div>
                                <div class="showed-content">
                                    <img src="../static/assets/images/portfolio-image.png" alt="">
                                </div>
                            </div>
                        </a>
                    </div>
                    <div class="col-lg-3 col-sm-6">
                        <a href="#">
                            <div class="item wow bounceInUp" data-wow-duration="1s" data-wow-delay="0.6s">
                                <div class="hidden-content">
                                    <h4>关键词建议</h4>
                                    <p>Lorem ipsum dolor sit ameti ctetur aoi adipiscing eto.</p>
                                </div>
                                <div class="showed-content">
                                    <img src="../static/assets/images/portfolio-image.png" alt="">
                                </div>
                            </div>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </section>

{% endblock %}

{% block script %}
    <!-- TODO:载入或写入js -->
    <script src="../static/js/jquery.min.js"></script>
    <script src="../static/js/bootstrap.bundle.min.js"></script>
    <script src="../static/js/jquery.sticky.js"></script>
    <script src="../static/js/click-scroll.js"></script>
    <script src="../static/js/custom.js"></script>

    <script>
        $(document).ready(function () {
            $(window).on('load', function () {
                // You can set focus to a different element based on your page structure
                // For example, setting focus to the body element
                console.log("已经准备就绪，调整焦点")
                $('#keyword').focus();
            });
            $('#search-btn').on('click', (e) => {
                e.preventDefault();
                let keyword = $('#keyword').val()
                if (keyword == '') {
                    alert('请输入一个合法的关键词')
                } else {
                    console.log(keyword);
                    // TODO:请求url，获得数据并实现渲染
                    $.ajax({
                        url: "/compkey/lists",
                        type: "GET",
                        dataType: "JSON",
                        data: {
                            seedword: keyword
                        },
                        success: function (res) {
                            console.log(res);
                            window.location.href = "/compkey/lists?seedword=" + encodeURIComponent(keyword);
                        },
                        error: (e) => {
                            console.log(e)
                        }
                    })
                }
            })
        })
        //等待用户不输入 0 秒后再去调用查询接口
        var loseInputMillsecs = 0;
        var clocker = null;

        function handleSearch() {
            // 执行你的搜索逻辑
            // 返回 false 阻止默认的表单提交行为
            return true;
        }

        // input搜索框的onkeyup事件函数

        function queryAllImpNo() {
            let keyword = $('#keyword').val();

            // if (keyword != null && keyword != '') {
            if (null == clocker) {
                clocker = setTimeout(loadImpNoList, loseInputMillsecs);
            } else { //连续击键，重新开始计时
                clearTimeout(clocker);
                clocker = setTimeout(loadImpNoList, loseInputMillsecs);
            }
        }

        // 调用查询接口，并将查询结果动态展示在配置好的ul内
        function loadImpNoList() {
            // let keyword = $('#keyword').val();
            // if (keyword == null || keyword == '') {
            //     return;
            // }
            let shouldHide = true;

            $.ajax({
                url: "/compkey/getHotwords",
                type: 'GET',
                contentType: 'application/json;charset=utf-8', // 设置请求头信息
                success: function (res) {
                    let data = res.seedwords;  // 在这里进行了更正
                    console.log(data);

                    // 每次查询数据时，将前一次查询的数据清除，否则会累加在 ul 中
                    $("#impNoListUl").find('div').remove();

                    // 对ul的背景颜色进行渲染
                    $("#impNoListUl").style = 'color:#ffffff !important;'
                    $("#impNoListUl").show();

                    // 如果查询结果为空，最好给个提示，否则用户会以为没有这个功能或功能失效
                    if (data == null || data == '' || data.length == 0) {
                        let ele = document.createElement('li');
                        ele.innerText = '(搜索无结果)';
                        $('#impNoListUl').append(ele);
                    } else {
                        for (let i = 0; i < data.length; i++) {
                            // 实现在 ul 中动态创建 li 列表，并将数据置入 li 列表中
                            let ele = document.createElement('li');

                            let ele2 = document.createElement('li');

                            let container = document.createElement('div');
                            container.style.display = 'flex';
                            container.style.paddingRight = '0';
                            container.style.alignItems = 'center'; // 垂直居中对齐
                            container.style.border = '2px solid #efefef'; // 设置边框宽度为2px，样式为实线，颜色为黑色
                            container.style.borderRadius = '10px'; // 设置圆角的大小为10px


                            // 插入一张图片作为左侧的装饰
                            let img = document.createElement('img');
                            img.src = '../static/images/huo.png'; // 替换为你的图片路径
                            img.alt = 'fire'; // 替换为你的图片描述
                            img.style.width = '20px'; // 根据需要设置图片宽度

                            // 设置图片的样式
                            img.style.marginRight = '8px'; // 根据需要设置图片和文字之间的间距

                            // 将图片添加到容器中
                            container.appendChild(img);

                            // 设置 li 的样式和文本
                            ele.style.color = '#717275';
                            ele.style.listStyleType = 'none';
                            ele.style.paddingBottom = '10px'
                            ele.innerText = data[i].word;  // 注意这里访问 word 属性

                            ele2.style.color = '#717275';
                            ele2.style.marginLeft = '250px'
                            ele2.style.listStyleType = 'none';
                            ele2.innerText = data[i].num + "次";  // 注意这里访问 word 属性

                            // 把 li 添加到 container 中
                            container.appendChild(ele)
                            container.appendChild(ele2)

                            // 将容器添加到 ul 中
                            $('#impNoListUl').append(container);
                        }
                        let ele = document.createElement('li');
                        ele.style.listStyleType = 'none';
                        ele.innerText = '     ';  // 注意这里访问 word 属性
                        $('#impNoListUl').append(ele);
                    }
                }
            });
        }

        // 此函数绑定了ul列表的点击事件，点击时实现将选中的值放入input搜索框中，调用页面的查询接口

        $(function () {
            $("#impNoListUl").bind("click", function () {

                //   ul里面那么多li   通过这行代码实现获取鼠标点击的li的值
                let innerText = document.elementFromPoint(event.clientX, event.clientY).innerText;

                // 如果是没有结果的，就不要获取值了，清除掉返回

                if (innerText == '(搜索无结果)') {
                    $("#impNoListUl").find('li').remove();
                    return;
                }

                // 将选中的值赋到input中
                $('#keyword').val(innerText);

                // 已经找到想要的了，ul里面的数据就没必要在占地方了
                $("#impNoListUl").find('div').remove();

                // 调用页面查询按钮接口，返回页面结果。
                // $('#search-btn').click();
            });
        });

    </script>
{% endblock %}